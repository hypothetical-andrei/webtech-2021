<html>
    <head>
        <script>
            function f(callback){
                let x 
                setTimeout(() => {
                    x = 100
                    let e = new Event('task_complete')
                    e.result = x
                    window.dispatchEvent(e)
                }, 1000)
            }

            f()

            window.addEventListener('task_complete', (evt) => {
                console.log('received ' + event.result)
            })
            
        </script>
    </head>
</html>